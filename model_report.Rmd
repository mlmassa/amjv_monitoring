---
title: "Modeling Forest Bird Abundance in the Appalachian Mountains Joint Venture's Virginia Highlands Focal Landscape"
author: 
  - Megan Massa | UMCES Appalachian Laboratory | meganlmassa@gmail.com
  - Emily B. Cohen | UMCES Appalachian Laboratory | emily.cohen@umces.edu
date: "July 24, 2023"
output: 
  bookdown::word_document2:
    reference_docx: 'report_template.docx'
    number_sections: false
    toc: true
    toc_depth: 2
bibliography: ./references.bib
csl: ./jwm_style.csl
link-citations: yes
---

```{r setup, include=FALSE}
# Load required packages
library(tidyverse)
library(unmarked)
library(MuMIn)
library(ggpubr)
library(flextable)

# Set options
knitr::opts_chunk$set(echo = F, message = F, warning = F)
options(knitr.kable.NA = '')
set_flextable_defaults(font.family = "Calibri", font.size = 12) 

# Load script to parse model outputs
source("scripts/wrangling/tidy_method_unmarked.R")

# Import data
counts <- 
  read_rds("data/raw/amjv_data.rds")$count_data

visits <- 
  read_rds("data/raw/amjv_data.rds")$visits |> 
  mutate(year = year(date))

points <- 
  read_rds("data/raw/amjv_data.rds")$points

plots <- 
  read_rds("data/raw/amjv_data.rds")$plots

veg <- 
  read_rds("data/raw/amjv_data.rds")$veg_data

spat_covs <-
  read_rds("data/processed/spat_covs.rds") |> 
  sf::st_drop_geometry()

tax <-
  read_csv("data/processed/species_list.csv")

# Fix the time and get sunrise
timefix <-
  visits |> 
  select(point_id, visit_id, date, start_time) |> 
  # Add coordinates of point
  left_join(points |> select(point_id, lat, long), by = "point_id") |> 
  # Add sunrise time
  left_join(
    suncalc::getSunlightTimes(
      data = 
        visits |> 
        select(point_id, date, start_time) |> 
        mutate(date = as.Date(date)) |> 
        left_join(
          points |> dplyr::select(point_id, lat, long), 
          by = "point_id") |> 
          select(date, lat, lon = long),
      keep = "sunrise",
      tz = "America/New_York") |> 
      as_tibble(),
    by = c("date", "lat", "long" = "lon"))

date(timefix$start_time) <- timefix$date
tz(timefix$start_time) <- "America/New_York"

visits <-
  visits |> 
  left_join(
    timefix |> 
      # Calculate time since sunrise
      mutate(
        diff = difftime(start_time, sunrise, units = "mins"),
        # Convert to numeric, "minutes after sunrise"
        start_sun = as.numeric(diff, units = "mins")) %>% 
      # Select only calculation, then append to visits
      select(visit_id, start_sun),
    by = "visit_id")

# Generate untidy dataset:
birds <-
  counts |> 
  left_join(visits, by = "visit_id") |> 
  left_join(points, by = "point_id") |> 
  left_join(plots, by = "plot_name")

# Load detection data
detections <-
  read_rds("data/processed/detections.rds")

# Set plot theme
theme_set(
  theme_bw(base_size = 11) +
  theme(
    axis.title.x = element_text(size = 10),
    axis.title.y = element_text(size = 10),
    axis.ticks = element_line(color = "gray"),
    panel.border = element_rect(fill = NA, color = "gray"),
    panel.grid.major = element_line(color = "gray95"),
    panel.grid.minor = element_blank(),
    strip.background = element_blank()))

# Set parameters for plots
sp <- c("SCTA", "WOTH", "WEWA")
sp_pal <- c("#F05E5C", "#E6A978", "#736B5E")
alpha <- 0.8
dodge_width <- 0.5

# Load model selection tables
aic_tab_list <- 
  map(
    sp,
    ~ read_rds(paste0("output/aictab_", .x, ".rds")) |> 
    as_tibble() |> 
    mutate(
      model = row_number(),
      across(
        where(is.numeric), 
        ~ round(.x, 2) |> as.character())) |> 
    pivot_longer(!(c(model, df, logLik, AIC, delta, weight)),
        names_to = "term",
        values_to = "estimate") |> 
    separate(
       term, 
       into = c("submodel", "term"), 
       sep = "\\(", 
       extra = "merge") |> 
    mutate(
       term = str_remove_all(term, "scale\\(") |> 
         str_remove_all("\\)") |> 
         str_replace("\\_5000", "est (5 km)") |> 
         str_replace("\\_1500", "est (1.5 km)") |> 
         str_replace("canopy_h", "canopy height") |> 
         str_replace("canopy_cv", "canopy variability") |> 
         str_replace("start_sun", "time of day") |> 
         str_replace("d_stream", "distance to stream") |> 
         str_replace("ed_buff", "edge density"), 
       submodel = str_replace_all(submodel, "lam", "λ"), 
       estimate = str_remove_all(estimate, "[0-9]") |> 
         str_remove_all("\\.")) |> 
      filter(!is.na(estimate), term != "Int") |> 
      filter(delta < 2)) |> 
  set_names(sp) |> 
  bind_rows(.id = "sp")

# Get vector of how many top models there are for each species
n_models <-
  distinct(aic_tab_list, sp, model) |> 
  summarize(n = length(sp), .by = sp) |> 
  pull(n) |> 
  set_names(sp)

formulas <-
  map(
    sp,
    function(s)
      map(
        1:n_models[[s]],
        function(m) 
          paste0(
            "p(", 
            filter(aic_tab_list, sp == s, model == m, submodel == "p") |> 
              pull(term) |> 
              paste(sep = "", collapse = " + ") , 
            ") +\nλ(", 
            filter(aic_tab_list, sp == s, model == m, submodel == "λ") |> 
              pull(term) |> 
              paste(sep = "", collapse = " + "), 
            ")")) |> 
      unlist() |> 
      as_tibble() |> 
      mutate(sp = s, model = row_number() |> as.character())) |> 
  bind_rows()

aic_tabs <-
  distinct(aic_tab_list, sp, df, logLik, AIC, delta, weight, model) |> 
  left_join(formulas)

# Load best models
mods_best <-
  map(
    sp,
    ~ read_rds(paste0("output/best_model_", .x, ".rds"))) |> 
  set_names(sp)

# Load averaged models
mods_avg <-
  map(
    sp,
    ~ read_rds(paste0("output/model_avg_", .x, ".rds"))) |> 
  set_names(sp)

# Load model betas
betas <-
  map(
    sp,
  ~ read_rds(paste0("output/model_avg_", .x, ".rds")) |> 
    pluck("coefficients") |> 
    data.frame() |> 
    tibble() |> 
    slice_tail(n = 1) |> 
    pivot_longer(
      cols = everything(), 
      names_to = "coefficient", 
      values_to = "estimate") |> 
    # Fix periods to parenthesis
    mutate(
      coefficient = 
        str_replace(coefficient, "\\.", "(") |> 
        str_replace("\\.", ")")) |> 
    # Add CI
    left_join(
      read_rds(paste0("output/model_avg_", .x, ".rds")) |> 
      confint(level = 0.85) |> 
      tibble() |> 
      pull(1) |> 
      as.data.frame() |> 
      rownames_to_column("coefficient") |> 
      rename(lower = 2, upper = 3),
      by = "coefficient")) |> 
  set_names(sp) |> 
  bind_rows(.id = "sp") |> 
  mutate(
    sp_long = case_when(
      sp == "SCTA" ~ "Scarlet Tanager", 
      sp == "WEWA" ~ "Worm-eating Warbler", 
      sp == "WOTH" ~ "Wood Thrush"),
    model = case_when(
      str_detect(coefficient, "p\\(") ~ "detection",
      str_detect(coefficient, "lam\\(") ~ "abundance",
      TRUE ~ "other"),
    coefficient = str_remove_all(coefficient, "lam\\(") |> 
      str_remove_all("p\\(") |> 
      str_remove_all("\\)"))

# Load predictions
files <- c(
  "output/preds_avg_WOTH.rds", 
  "output/preds_avg_SCTA.rds", 
  "output/preds_avg_WEWA.rds")

preds_avg <-
  map(
    1:length(read_rds(files[[1]])),
    function(x)
      map(
        files,
        function(y)
          read_rds(y) |> 
          pluck(x)) |> 
        list_rbind()) |> 
  set_names(names(read_rds(files[[1]]))) |> 
  # Calculate 85% CI
  map(
    ~ mutate(
      .x, 
      lower = fit - (1.96 * se.fit), 
      upper = fit + (1.96 * se.fit), 
      Predicted = fit))

files <- c(
  "output/preds_WOTH.rds", 
  "output/preds_SCTA.rds", 
  "output/preds_WEWA.rds")

preds <-
  map(
    1:length(read_rds(files[[1]])),
    function(x)
      map(
        files,
        function(y)
          read_rds(y) |> 
          pluck(x)) |> 
        list_rbind()) |> 
  set_names(names(read_rds(files[[1]]))) |> 
  # Calculate 85% CI
  map(
    ~ mutate(
      .x, 
      lower = Predicted - (1.96 * SE), 
      upper = Predicted + (1.96 * SE)))

```

`r knitr::include_graphics("cnmm_overlook_crop.jpg")`

```{r, out.width = "33%", fig.show = 'hold', fig.align = 'center'}
knitr::include_graphics(c("UMCES-AL-logo.jpg", "ABC logo.png","National_Fish_and_Wildlife_Foundation_Logo.jpg"))
``` 

# Introduction

The Appalachian Mountains Joint Venture's Virginia Highlands Focal Landscape encompasses a vast expanse of forested habitat, harboring many forest bird species of conservation concern. To ensure the effectiveness of multi-species conservation and management, it is imperative to understand baseline conditions within this focal landscape. 

Within this context, our study aimed to investigate the impact of environmental covariates and forest structure on the abundance of focal forest bird species in the Virginia Highlands Focal Landscape. Future conservation planning within this region is centered around the restoration of forest age class and structural diversity. As such, this research on existing forest stand composition and local species-habitat relationships contributes to the broader multi-species conservation planning efforts, offering insight into the unique ecological dynamics of this particular landscape.

Our objectives were to examine the impact of environmental covariates and forest structure on the abundance of focal forest bird species, and to quantify the average densities of focal species in the focal landscape. In this report, we present the results of our two-year bird survey effort and explore the relationship between forest bird abundance and environmental and forest structural factors. The findings of this study contribute to the existing body of research on forest bird ecology and provide valuable information for future work within the Focal Landscape.

```{r maps, fig.cap = "Map of study area. Sampling blocks are indicated in yellow. White lines indicate roads. Effects monitoring points are represented by triangles, and population monitoring points by circles. (A) Gathright area, consisting of state, private, federal, and NGO properties near T.M. Gathright WMA and Warm Springs Mountain in Bath County, VA. (B) Goshen area, consisting of state and federal properties around Goshen and Little North Mountain WMA in Rockbridge County, VA. (C) Potts area, consisting of points within the George Washington National Forest in Alleghany County, VA."}
knitr::include_graphics("output/plots/map_edit.png")
```

# Methods

We performed point count surveys during 2021 and 2022 in Bath, Rockbridge, and Alleghany Counties in Virginia (Figure \@ref(fig:maps)). Points consisted of both population and effects monitoring, with at least four points surveyed per sampling unit. In total, we performed 418 surveys at 134 points, 89 of which were visited in both years.

## Surveys

Surveys began 30 minutes before local sunrise and ran until 4 hours after sunrise, although some surveys were conducted slightly later.
Observers recorded covariates that might affect species detections, including cloud cover, precipitation, wind, the date, and the observer's identity. These measurements were mostly similar across year except for observer and day of year. In 2022 the field season occurred earlier (Figure \@ref(fig:detcovs)).

```{r detcovs, fig.cap = "Summary of observation covariates.", dpi = 300, fig.width = 6.5, fig.height = 6.2}
det_plots <-
  list(
    cloud = 
      ggplot(data = visits |> filter(!is.na(cloud), !is.na(year))) +
      geom_histogram(aes(x = cloud), binwidth = 10) +
      facet_wrap(vars(year), nrow = 2) +
      labs(
        y = "Surveys",
        x = "Cloud cover (%)") +
      coord_cartesian(expand = T, clip = "off"),
    doy = 
      ggplot(
      data = visits |> 
        filter(!is.na(date), !is.na(year)) |> 
        mutate(doy = as.Date(yday(date) - 1, origin = "2023-01-01"))) +
      scale_x_date(
        date_breaks = "7 days",
        labels = scales::label_date("%b %d")) +
      geom_histogram(aes(x = doy), binwidth = 1) +
      facet_wrap(vars(year), nrow = 2) +
      labs(
        y = "Surveys",
        x = "Day of year") +
      coord_cartesian(expand = T, clip = "off"),
    observer = 
      ggplot(data = visits |> filter(!is.na(observer), !is.na(year))) +
      geom_bar(aes(x = observer)) +
      facet_wrap(vars(year), nrow = 2) +
      labs(
        y = "Surveys",
        x = "Observer") +
      coord_cartesian(expand = T, clip = "off"),
    precip = 
      ggplot(data = visits |> filter(!is.na(precip), !is.na(year))) +
      geom_bar(aes(x = precip)) +
      facet_wrap(vars(year), nrow = 2) +
      labs(
        y = "Surveys",
        x = "Precipitation") +
      coord_cartesian(expand = T, clip = "off"),
    time = 
      ggplot(data = visits |> filter(!is.na(start_sun), !is.na(year))) +
      geom_histogram(aes(x = start_sun), binwidth = 10) +
      # geom_vline(xintercept = (4*60)) +
      facet_wrap(vars(year), nrow = 2) +
      scale_x_continuous(breaks = c(0, 60, 120, 180, 240, 300)) +
      labs(
        y = "Surveys",
        x = "Start time (minutes after sunrise)") +
      coord_cartesian(expand = T, clip = "off"),
    visits =
      ggplot(data = visits |> filter(!is.na(wind), !is.na(year))) +
      geom_bar(aes(x = factor(wind))) +
      facet_wrap(vars(year), nrow = 2) +
      labs(
        y = "Surveys",
        x = "Wind (Beaufort scale)") +
      coord_cartesian(expand = T, clip = "off"),
    temp =
      ggplot(data = visits |> filter(!is.na(temp), !is.na(year))) +
      geom_histogram(aes(x = temp), binwidth = 0.5) +
      facet_wrap(vars(year), nrow = 2) +
      labs(
        y = "Surveys",
        x = "Temperature (C)") +
      coord_cartesian(expand = T, clip = "off")
    )

det_gg <-
  ggarrange(
    det_plots$cloud,
    det_plots$doy,
    det_plots$observer,
    det_plots$precip,
    det_plots$time,
    det_plots$visits,
    ncol = 2,
    nrow = 3
    #labels = map(LETTERS[1:6], ~paste0("(", .x, ")")) |> list_c()
    )

det_gg

```

## Focal species

Species of interest included Black-billed Cuckoo, Canada Warbler, Cerulean Warbler, Kentucky Warbler, Ruffed Grouse, Scarlet Tanager, Worm-eating Warbler, Wood Thrush, and Yellow-billed Cuckoo. Of these species, only Scarlet Tanager, Worm-eating Warbler, and Wood Thrush had a sufficient number of surveys with detections (> 100) to model abundance (Figure \@ref(fig:focalsp)). Although we recorded birds detected at any distance, for this analysis we only considered individuals detected within 100 m of the point.

```{r focalsp, fig.cap = "Observed abundances of focal species during point counts. Species with fewer than 100 total detections were not suitable for abundance modeling.", dpi = 300, fig.width = 5.75, fig.height = 3.75}
detections |> 
  left_join(
    tax,
    by = join_by(species == bandingCodes)) |> 
  filter(!is.na(abund)) |> 
  ggplot() + 
  geom_bar(aes(x = factor(abund))) + 
  facet_wrap(vars(comName), scales = "free_y") +
  labs(x = "Abundance (birds/survey)", y = "Surveys") +
  coord_cartesian(expand = T, clip = "off")
```

## Site characteristics

We used remotely-sensed habitat data known to impact interior forest species, including forest cover, edge metrics, water, and tree canopy.

### Habitat type

Proximity to water influences local habitat type, and certain forest species including Wood Thrush nest closer to streams [@bertin1977]. We used the Virginia Department of Conservation and Recreation's water shapefiles [@vadcr2022] to calculate distance to stream as the minimum distance to any linear or area water feature.

To investigate the impact of forest community types, we used a shapefile developed by the Nature Conservancy [@simon2011] to determine the ecozone, that is, the plant community group as based on environmental and physical factors, at each point. We reclassified detailed ecozones to 8 broader categories following @lorber2018 (Table \@ref(tab:xwalk)). For maps of ecozones surrounding surveyed points, see [Appendix I].

```{r xwalk}
readxl::read_xls("data/raw/zone_codes.xls") |> 
  arrange(-New_Value) |> 
  select(
    Code = Value, 
    `Original ecozone` = ecozone, 
    `Reclassification` = GWNF_model,
    `New Code` = New_Value) |> 
  flextable() |> 
  merge_v(j = 3:4) |> 
  set_caption(
    "Cross-walk of detailed and simplified ecozone classifications adapted from Lorber et al. (2018).") |>  
  autofit() |> 
  theme_box()
```

### Forest and edge structure

Enhancing structural diversity is a major goal of the Dynamic Forest Restoration Blocks. Lacking detailed information about stand history and management, we calculated the mean canopy height within 50 m of the survey point from LiDAR data. Using these same LiDAR data we also calculated the coefficient of variation (CV) of canopy height within the survey radius (100 m) as a measurement of structural heterogeneity, with a higher CV indicating a more variable canopy height. Additionally, observers measured stand basal area in the field using a prism, with one reading at the survey point. However, a high proportion of points (n = 28) were missing this covariate, so we excluded it from full models and modeled it separately.

Forest loss and fragmentation are major contributors to the decline of interior forest bird species via the reduction of nesting success [@robinson1995]. To determine the impact of surrounding forest cover on abundance, we using the 2019 National Land Cover Database [@dewitz2021], combining the categories of deciduous, evergreen, and mixed forest together. We then calculated the percent forested cover at two spatial scales, 1.5 km and 5 km. These scales are known to be relevant to at least one species, Wood Thrush [@driscoll2005].
We calculated edge density (m/ha) within 1.5 km using the R package `landscapemetrics` [@hesselbarth2019]. We attempted to calculate patch core area and patch perimeter:area ratio using this package, but forest patches in this region are largely continuous and most points were located in the same large patches, each measuring over 9,000 ha in area.

```{r abundcovs, fig.cap = "Summary of site covariates used in abundance models.", dpi = 300, fig.width = 6.5, fig.height = 8}
abund_plots <-
  list(
  owner =
    points |> 
    left_join(plots) |> 
    ggplot() +
    geom_bar(aes(x = ownership)) +
    labs(x = "Ownership", y = "Points") +
    coord_cartesian(expand = T, clip = "off"),
  
  ecozone = 
    spat_covs |> 
    ggplot() +
    geom_bar(aes(x = forcats::fct_infreq(ecozone))) +
    labs(x = "Ecozone", y = "Points") +
    scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
    coord_flip(clip = "off"),
  
  basal = 
    veg |> 
    ggplot() +
    geom_histogram(aes(x = basal_area), binwidth = 10) +
    labs(x = "Basal area", y = "Points") +
    coord_cartesian(expand = T, clip = "off"),
  
  forest = 
    spat_covs |> 
    select(point_id, for_1500, for_5000) |> 
    pivot_longer(cols = c(for_1500, for_5000)) |> 
    mutate(
      name = if_else(name == "for_1500", "1.5 km", "5 km")) |> 
    ggplot() +
    geom_histogram(aes(x = value), binwidth = .01) +
    facet_wrap(~name, nrow = 2) +
    labs(x = "Prop. forest within buffer", y = "Points") +
    coord_cartesian(expand = T, clip = "off"),
  
  edge =
    spat_covs |> 
    ggplot() +
    geom_histogram(aes(x = ed_buff), bins = 30) +
    labs(x = "Edge density (m/ha)", y = "Points") +
    coord_cartesian(expand = T, clip = "off"),
    
    
  d_stream = 
    spat_covs |> 
    mutate(d_stream = units::drop_units(d_stream)) |> 
    ggplot() +
    geom_histogram(aes(x = d_stream), binwidth = 25) +
    labs(x = "Distance to stream (m)", y = "Points") +
    coord_cartesian(expand = T, clip = "off"),
    
  canh =
    spat_covs |> 
    ggplot() +
    geom_histogram(aes(x = canopy_h), binwidth = 2) +
    labs(x = "Canopy height (m)", y = "Points") +
    coord_cartesian(expand = T, clip = "off"),
    
  cancv = 
    spat_covs |> 
    ggplot() +
    geom_histogram(aes(x = canopy_cv), bins = 28) +
    labs(x = "CV of canopy height", y = "Points") +
    coord_cartesian(expand = T, clip = "off")
  )

abund_gg <-
  ggarrange(
    abund_plots$owner,
    abund_plots$ecozone,
    abund_plots$forest,
    abund_plots$edge,
    abund_plots$basal,
    abund_plots$d_stream,
    abund_plots$canh,
    abund_plots$cancv,
    ncol = 2,
    nrow = 4
    #labels = map(LETTERS[1:8], ~paste0("(", .x, ")")) |> list_c()
    )

abund_gg

```

## Modeling

We modeled the hierarchical processes of detection and abundance of focal species using the `pcount` function in the R package `unmarked` [@fiske2011], which fits the N-mixture model of @royle2004 to spatially replicated count data.
In this model, detection $p$ is modeled as a binomial process impacted by conditions during the survey, and for abundance $\lambda$ we used a zero-inflated Poisson model [@joseph2009].
In these models we treated each site-year combination independently, including year as a factor covariate in all models.
This is a common approach in occupancy and abundance modeling to use a non-temporally explicit model where sampling took place across a limited number of years (e.g. @fogg2014).

We used the `dredge` function from package `MuMIn` for model selection and model averaging [@barton2023]. This method compared all possible models, as we had no particular hypotheses about which of the environmental or survey conditions would best predict each species.
We first fit a detection model while holding abundance constant and then fit all candidate abundance models using the top detection model as determined by Akaike Information Criterion (AIC), [@aicc1989]. 
We scaled all covariates using the `scale` function, which centers values on the mean and divides by the standard deviation and excluded all models that contained covariates that were correlated $|r|$ > 0.5. The pairs of correlated covariates were forest within 1.5 km and edge density within 1.5 km ($r$ = -0.87), canopy height within 50 m and the CV of canopy height within 100 m ($r$ = -0.69).

To produce model-averaged estimates and predictions, we averaged coefficients of all models within 2AIC by model weights. 
Instead of using p-values, we considered model parameters to be uninformative if the 85% confidence interval for the parameter estimate included zero [@arnold2010].
For predicted abundances, we set all covariates other than the target covariate to their mean or modal value.
Several covariates of interest could not be included in the full model sets because they did not converge or because sample size differed. For land ownership, ecozone, and basal area, we report predictions from stand-alone models.
For species without sufficient data to model abundance, we calculated descriptive statistics of the conditions in which they occurred.
All analyses were conducted in R version 4.3.0 [@rcoreteam2023].


```{r}
modeltable <- function(s) {
  
  model <- pluck(mods_avg, s)
  
  # Get confidence intervals
  bind_rows(
    confint(model, type = "state", level = 0.85) |> 
      as.data.frame() |> 
      rownames_to_column(),
    confint(model, type = "det", level = 0.85) |> 
      as.data.frame() |> 
      rownames_to_column()) |> 
    
  separate_wider_delim(rowname, "(", names = c("model", "term"), too_many = "merge") |> 
  select(model, term, lower = 3, upper = 4) |> 
  mutate(term = str_remove(term, "\\)")) |> 
  group_by(model, term) |> 
  slice_head(n = 1) |> 
    
  left_join(
    model$coefficients |> 
    as.data.frame() |> 
    rownames_to_column() |> 
    filter(rowname == "subset") |> 
    pivot_longer(
      !rowname, 
      values_to = "estimate") |> 
      separate_wider_delim(name, "(", names = c("model", "term"), too_many = "merge") |> 
      mutate(term = str_remove(term, "\\)"))) |> 
    
  mutate(
    term = str_remove(term, "scale\\(") |> str_remove("\\)"),
    term = 
      str_replace(term, "start_sun", "time of day") |> 
      str_replace("wind", "wind: ") |> 
      str_replace("canopy_cv", "canopy variability") |> 
      str_replace("canopy_h", "canopy height") |> 
      str_replace("d_stream", "distance to stream") |> 
      str_replace("ed_buff", "edge density") |> 
      str_replace("for_1500", "forest (1.5 km)") |> 
      str_replace("for_5000", "forest (5 km)") |> 
      str_replace("year", "year: ") |> 
      str_replace("doy", "day of year"),
    model = if_else(model == "lam", "λ (abundance)", "p (detection)"),
    across(where(is.numeric), round, 2),
    ci = paste(lower, upper, sep = " — "),
    informative = if_else(sign(lower) != sign(upper), "Uninformative", NA_character_)) |> 
  arrange(model, term) |> 
  filter(term != "Int", term != "psi", term != "Int") |> 
  select(model, term, estimate, lower, upper, informative)
  
}

```

# Results

## Model outputs
### Scarlet Tanager

Scarlet Tanager detectability was negatively impacted by cloud cover, strong wind, and later survey time (Table \@ref(tab:betascta)). Mean estimated detection probability was 0.49 (95% CI = 0.36, 0.62). 

There were 9 competitive models for Scarlet Tanager abundance (Table \@ref(tab:aicscta)). The averaged abundance model included a negative impact of canopy height variability, and edge density (Table \@ref(tab:betascta)). Canopy height, forest within 1.5 km, and forest within 5 km all had a positive impact on abundance. Year (negative), distance to stream (positive), and canopy height (positive) were all uninformative parameters. Mean estimated abundance was 2.2 individuals (95% CI = 1.69, 1.85) per count circle. 

```{r aicscta}
aic_tabs |> filter(sp == "SCTA") |> 
  select(-sp, -model) |> 
  relocate(6, 1) |> 
  rename(formula = value, LL = logLik, ΔAIC = delta) |> 
flextable() |> 
  set_caption(
    "Model selection table for Scarlet Tanager including model formula, degrees of freedom (df), log-likelihood (LL), Aikaike's Information Criterion (AIC), delta AIC, and model weight. In model formulas, p indicates detection model and λ indicates abundance model. We present all models included in model averaging, i.e. all models < 2 ΔAIC.") |>  
  width(j =  1, width = 3.2) |> 
  width(j = 2, width = 0.4) |> 
  width(j = 3:6, width = 0.675) |> 
  theme_box()
```

<br>

```{r betascta}
modeltable("SCTA") |> 
  flextable() |> 
  merge_v(j = 1) |> 
  set_caption(
    "Model-averaged estimates for Scarlet Tanager abundance. Lower and upper indicate 85% confidence interval (CI). Uninformative parameters were included in one or more competitive models but had an 85% confidence interval overlapping zero.") |>  
  autofit() |> 
  theme_box()
```

### Wood Thrush

Detectability of Wood Thrush was negatively impacted by cloud cover and later survey time.
Mean estimated detection probability was 0.37 (95% CI = 0.25, 0.52).

There were 9 competitive models for Wood Thrush abundance (Table \@ref(tab:aicwoth)).
The averaged abundance model included a positive impact of canopy height (Table \@ref(tab:betawoth)). Wood Thrush abundance also differed by year, being lower in 2022. However, this may be due to different locations sampled and a difference in timing as 2022 surveys were earlier in the year (Figure \@ref(fig:detcovs)).
Contrary to existing research, we did not find a conclusive impact of distance to stream, which had an averaged model estimate of zero. Other uninformative parameters included greater edge density, which had a negative impact on abundance, and forest within 1.5 km and 5 km, both of which had a positive impact. Mean estimated abundance was 1.38 individuals (95% CI = 0.93, 2.06) per count circle. 

```{r aicwoth}
aic_tabs |> filter(sp == "WOTH") |> 
  select(-sp, -model) |> 
  relocate(6, 1) |> 
  rename(formula = value, LL = logLik, ΔAIC = delta) |> 
flextable() |> 
  set_caption(
    "Model selection table for Wood Thrush including model formula, degrees of freedom (df), log-likelihood (LL), Aikaike's Information Criterion (AIC), delta AIC, and model weight. In model formulas, p indicates detection model and λ indicates abundance model. We present all models included in model averaging, i.e. all models < 2 ΔAIC.") |>  
  width(j =  1, width = 3.2) |> 
  width(j = 2, width = 0.4) |> 
  width(j = 3:6, width = 0.675) |> 
  theme_box()
```

<br>

```{r betawoth}
modeltable("WOTH") |> 
  flextable() |> 
  merge_v(j = 1) |> 
  set_caption(
    "Model-averaged estimates for Wood Thrush abundance. Lower and upper indicate 85% confidence interval (CI). Uninformative parameters were included in one or more competitive models but had an 85% confidence interval overlapping zero.") |>  
  autofit() |> 
  theme_box()
```

### Worm-eating Warbler

Detectability of Worm-eating Warbler was negatively impacted by cloud cover, wind, and later survey time. Mean estimated detection probability was 0.42 (95% CI = 0.23, 0.62).

There were 10 competitive models for Worm-eating Warbler abundance (Table \@ref(tab:aicwewa)). The averaged abundance model included a negative impact of edge density and forest within 5km (Table \@ref(tab:betawewa)). There were several uninformative parameters including canopy height (negative), canopy variability (negative), distance to stream (negative), forest within 1.5 km (negative), and year (negative). Mean predicted abundance was 2.11 individuals (95% CI = 1.31, 3.38) per count circle. 

```{r aicwewa}
aic_tabs |> filter(sp == "WEWA") |> 
  select(-sp, -model) |> 
  relocate(6, 1) |> 
  rename(formula = value, LL = logLik, ΔAIC = delta) |> 
flextable() |> 
  set_caption(
    "Model selection table for Worm-eating Warbler including model formula, degrees of freedom (df), log-likelihood (LL), Aikaike's Information Criterion (AIC), delta AIC, and model weight. In model formulas, p indicates detection model and λ indicates abundance model. We present all models included in model averaging, i.e. all models < 2 ΔAIC.") |>  
  width(j =  1, width = 3.2) |> 
  width(j = 2, width = 0.4) |> 
  width(j = 3:6, width = 0.675) |> 
  theme_box()
```

<br>

```{r betawewa}
modeltable("WEWA") |> 
  flextable() |> 
  merge_v(j = 1) |> 
  set_caption(
    "Model-averaged estimates for Worm-eating Warbler abundance. Lower and upper indicate 85% confidence interval (CI). Uninformative parameters were included in one or more competitive models but had an 85% confidence interval overlapping zero.") |>  
  autofit() |> 
  theme_box()
```

## Summary of covariate impacts
```{r makeplots}
# owner | for15 for50 | dstream | eco | ed canh cancv
plot_for1k <- 
  preds_avg$for_1500 |> 
  ggplot(aes(x = 100*for_1500)) +
  geom_ribbon(
    aes(ymin = lower, ymax = upper, color = sp_long, fill = sp_long),
    alpha = alpha) +
  geom_line(aes(y = Predicted)) +
  labs(
    y = "Predicted abundance",
    x = "% forest within 1.5 km") +
  theme(legend.position = "none", axis.text.x = element_text(size = 8)) +
  facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "off")

plot_for5k <-
  preds_avg$for_5000 |> 
  ggplot(aes(x = 100*for_5000))+
  geom_ribbon(
    aes(ymin = lower, ymax = upper, color = sp_long, fill = sp_long),
    alpha = alpha) +
  geom_line(aes(y = Predicted)) +
  labs(
    y = "Predicted abundance",
    x = "% forest within 5 km") +
  theme(legend.position = "none", axis.text.x = element_text(size = 8)) +
  facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "off")

plot_ed <-
  preds_avg$ed_buff |> 
  ggplot(aes(x = ed_buff))+
  geom_ribbon(
    aes(ymin = lower, ymax = upper, color = sp_long, fill = sp_long),
    alpha = alpha) +
  geom_line(aes(y = Predicted)) +
  labs(
    y = "Predicted abundance",
    x = "Edge density (m/ha)") +
  theme(legend.position = "none") +
  facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "off")

plot_stream <-
  preds_avg$d_stream |> 
  ggplot(aes(x = d_stream))+
  geom_ribbon(
    aes(ymin = lower, ymax = upper, color = sp_long, fill = sp_long),
    alpha = alpha) +
  geom_line(aes(y = Predicted)) +
  labs(
    y = "Predicted abundance",
    x = "Distance to stream (m)") +
  theme(legend.position = "none") +
  facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "off")

plot_canh <-
  preds_avg$canopy_h |> 
  ggplot(aes(x = canopy_h))+
  geom_ribbon(
    aes(ymin = lower, ymax = upper, color = sp_long, fill = sp_long),
    alpha = alpha) +
  geom_line(aes(y = Predicted)) +
  labs(
    y = "Predicted abundance",
    x = "Canopy height (m)") +
  theme(legend.position = "none") +
  facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    xlim = c(0, 30),
    expand = T, clip = "on")

plot_cancv <- 
  preds_avg$canopy_cv |> 
  ggplot(aes(x = canopy_cv))+
  geom_ribbon(
    aes(ymin = lower, ymax = upper, color = sp_long, fill = sp_long),
    alpha = alpha) +
  geom_line(aes(y = Predicted)) +
  labs(
    y = "Predicted abundance",
    x = "CV of canopy height") +
  theme(legend.position = "none") +
  facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "on")

plot_own <-
  preds$ownership |> 
  ggplot(aes(x = reorder(ownership, desc(Predicted)))) +
  geom_errorbar(
    width = 0.5,
    position = position_dodge(width = dodge_width),
    aes(y = Predicted, ymin = lower, ymax = upper, color = sp_long)) +
  geom_point(
    position = position_dodge(width = dodge_width),
    size = 2.5,
    aes(y = Predicted, color = sp_long, shape = sp_long)) +
  labs(
    y = "Predicted abundance",
    x = "Ownership",
    color = "",
    shape = "") +
  theme(
    legend.position = "top",
    #legend.justification = c(0, 0.8),
    legend.background = element_blank()) +
  #facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "on")

plot_eco <-
  preds$ecozone |> 
  mutate(lower = if_else(lower<0, 0, lower)) |> 
  filter(ecozone != "barrens") |> 
  ggplot(aes(x = ecozone)) +
  geom_errorbar(
    width = 0.5,
    position = position_dodge(width = 0.5),
    aes(y = Predicted, ymin = lower, ymax = upper, color = sp_long)) +
  geom_point(
    position = position_dodge(width = 0.5),
    size = 2.5,
    aes(y = Predicted, color = sp_long, shape = sp_long)) +
  labs(
    y = "Predicted abundance",
    x = "Ecozone",
    color = "",
    shape = "") +
  theme(
    legend.position = "top",
    #legend.justification = c(0, 0.8),
    legend.background = element_blank()) +
  #facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "on")

plot_basal <-
  preds$basal |> 
  ggplot(aes(x = basal))+
  geom_ribbon(
    aes(ymin = lower, ymax = upper, color = sp_long, fill = sp_long),
    alpha = alpha) +
  geom_line(aes(y = Predicted)) +
  labs(
    y = "Predicted abundance",
    x = "Basal area") +
  theme(legend.position = "none") +
  facet_wrap(~sp_long) +
  scale_color_manual(values = sp_pal) +
  scale_fill_manual(values = sp_pal) +
  coord_cartesian(
    ylim = c(0, NA),
    expand = T, clip = "on")
```

Landscape composition impacted occupancy. Forest cover within was generally positive for focal species. For example, predicted Wood Thrush abundance increased by 0.38 birds/count as forest within 1.5 km increased from 75% to 99% (Figure \@ref(fig:predfor)). However, a notable exception was Worm-eating Warbler, which responded negatively to forest within 5 km (Figure \@ref(fig:predfor)). The amount of fragmentation in the surrounding landscape as measured by edge density also impacted focal species, some more than others. Scarlet Tanager and Worm-eating Warbler abundance responded negatively to edge density, but Wood Thrush was not strongly impacted (Figure \@ref(fig:predfor)). 

```{r predfor, fig.cap = "Model-averaged predictions of abundance by forest cover at two spatial scales, (A) 1.5 km and (B) 5 km, as well as (C) by increasing fragmentation as measured by edge density. Shaded areas indicate 95% confidence intervals.", dpi = 300, fig.width = 5.5, fig.height = 6.15}
ggarrange(
  plot_for1k +
    theme(panel.spacing.x = unit(4, "mm")), 
  plot_for5k +
    theme(panel.spacing.x = unit(4, "mm")),
  plot_ed +
    theme(panel.spacing.x = unit(4, "mm")),
  ncol = 1,
  labels = c("A", "B", "C"),
  label.x = 0,
  hjust = -0.5,
  vjust = 1.5
)
```

Abundance did not differ significantly by ecozone (Figure \@ref(fig:predecozone)) although we sometimes observed fewer individuals of focal species in floodplain forests and the highest abundances of Scarlet Tanager and Worm-eating Warbler occurred in dry pine-oak habitats. Although we observed some individuals in barrens, so few points were in barrens that we could not estimate abundance in this ecozone.

```{r predecozone, fig.cap = "Predicted abundance by ecozone was modeled separately. Ecozone was not included in any top models. Error bars indicate 95% confidence intervals.", dpi = 300, fig.width = 6, fig.height = 3}
plot_eco
```

Local forest structure was important to all three modeled species. Basal area (modeled separately) had a strong positive impact on all focal species; predicted Worm-eating Warbler abundance increased from 1.41 to 2.41 individuals/survey as basal area increased from 10 to 180 (Figure \@ref(fig:predcanopy)A). Higher average canopy height only increased abundance of Wood Thrush (Figure \@ref(fig:predcanopy)B). Canopy height variability was neutral for Wood Thrush and Worm-eating Warbler and negative for Scarlet Tanager (Figure \@ref(fig:predcanopy)C), indicating that Scarlet Tanager was more abundant in even-height stands. Distance to water was an uninformative parameter for all three species and did not have a significant impact.

```{r predcanopy, fig.cap = "Predicted abundance by forest structure, (A) stand basal area, modeled separately; (B) canopy height; and (C) canopy height variability (CV of canopy height). Shaded areas indicate 95% confidence intervals.", dpi = 300, fig.width = 5.75, fig.height = 6.5}
ggarrange(
  plot_basal,
  plot_canh,
  plot_cancv,
  ncol = 1,
  labels = c("A", "B", "C"),
  label.x = 0,
  hjust = -0.5,
  vjust = 1.5
)
```

We modeled abundance separately by ownership to summarize observed differences in abundance. Abundance did not differ significantly by owner (Figure \@ref(fig:predown)), but on federally-owned plots, Wood Thrush abundance was lower than that of other species.

```{r predown, fig.cap = "Predicted abundance by ownership was modeled separately. Error bars indicate 95% confidence intervals.", dpi = 300, fig.width = 5, fig.height = 3}
plot_own

```

## Other species of interest

Here we summarize habitat and landscape conditions where other species of interest were present. These species could not be modeled, but the conditions in which they occurred are still of interest.

```{r}
# Load data
present <-
  detections |> 
  filter(det == 1, !species %in% sp) |> 
  distinct(point_id, species) |> 
  # Add plot info
  left_join(points, by = "point_id") |> 
  left_join(plots, by = "plot_name") |> 
  select(point_id, species, plot_type, ownership) |> 
  # Add basal area
  left_join(
    veg |> 
    distinct(point_id, basal_area) |> 
    summarize(
      basal = mean(basal_area, na.rm = T), .by = point_id) |> 
    filter(!is.na(basal)),
  by = "point_id") |> 
# Add spatial covariates (lsm, area, stream, forest...)
  left_join(
    sf::st_drop_geometry(spat_covs),
    by = "point_id") |> 
  mutate(d_stream = units::drop_units(d_stream))

pres_sum <-
  present |> 
  select(species, where(is.numeric)) |> 
  pivot_longer(-species) |> 
  summarize(
    points = n(),
    mean = mean(value, na.rm = T) |> round(2),
    min = min(value, na.rm = T) |> round(2),
    max = max(value, na.rm = T) |> round(2),
    sd = sd (value, na.rm = T) |> round(2),
    se = (sd/points) |> round(2),
    .by = c(species, name)
  )

# Function to print table for that species
pres_tabler <- 
  function(s, S) {
    t <- filter(pres_sum, species == s)
    t |> 
    mutate(
      range = str_c(min, max, sep = "—"),
      name = 
        str_replace(name, "basal", "basal area") |> 
        str_replace("core", "patch core area (ha)") |> 
        str_replace("para", "patch perimeter:area ratio") |> 
         str_replace("\\_5000", "est (5 km)") |> 
         str_replace("\\_1500", "est (1.5 km)") |> 
         str_replace("canopy_h", "canopy height (m)") |> 
         str_replace("canopy_cv", "canopy variability") |> 
         str_replace("start_sun", "time of day") |> 
         str_replace("d_stream", "distance to stream (m)") |> 
         str_replace("ed_buff", "edge density (m/ha)")) |> 
    select(name, mean, sd, range) |> 
    # mutate(name = c("Stand basal area", "Forest cover (1.5 km)", "Forest cover (5 km)", "Patch core area (ha)", "Patch perimeter:area ratio", "Distance to stream (m)", "Edge density (m/ha)", "Canopy height (m)")) |> 
    flextable() |> 
    set_header_labels(name = "Covariate", mean = "Mean", sd = "SD", range = "Range") |> 
    set_caption(paste("Summary of numerical site covariates for locations (n = ", t$points[[1]], "points) where", S, "was detected.")) |> 
    autofit() |> 
    fit_to_width(max_width = 6) |> 
    theme_box()
}
  

sum_eco <- 
  present |> 
  count(species, ecozone) |> 
  group_by(species) |> 
  mutate(p = (100 * n/sum(n)) |> round(1)) |> 
  arrange(species, desc(p)) 

ecoz <- function(s) {
  sum_eco_sp <- filter(sum_eco, species == s)
  map(
    1:nrow(sum_eco_sp),
    ~paste0(sum_eco_sp[[.x, 2]], " (n = ", sum_eco_sp[[.x, 3]], ", ", sum_eco_sp[[.x, 4]], "%)")) |> 
    paste(collapse = "; ") |> 
    str_replace("(.*);", "\\1, and")
}

plotz <- function(s) {
  present |> 
  count(species, plot_name) |> 
  filter(species == s) |> 
  pull(plot_name) |> 
  paste(collapse = ", ") |> 
  str_replace("(.*),", "\\1 and")
}
```

### Black-billed Cuckoo

Black-billed Cuckoo was present in `r ecoz("BBCU")` ecozones. It was detected at `r plotz("BBCU")`.

```{r bbcutable}
pres_tabler("BBCU", "Black-billed Cuckoo")
```

### Canada Warbler

Canada warbler was present in `r ecoz("CAWA")` ecozones. It was detected at `r plotz("CAWA")`.

```{r cawatable}
pres_tabler("CAWA", "Canada Warbler")
```

### Cerulean Warbler

Cerulean Warbler was present in `r ecoz("CERW")` ecozones. It was detected at `r plotz("CERW")`.

```{r cerwtable}
pres_tabler("CERW", "Cerulean Warbler")
```

### Kentucky Warbler

Kentucky Warbler was present in `r ecoz("KEWA")` ecozones. It was detected at `r plotz("KEWA")`.

```{r kewatable}
pres_tabler("KEWA", "Kentucky Warbler")
```

### Ruffed Grouse

Ruffed Grouse was present in `r ecoz("RUGR")` ecozones. It was detected at `r plotz("RUGR")`.

```{r rugrtable}
pres_tabler("RUGR", "Ruffed Grouse")
```

### Yellow-billed Cuckoo

Yellow-billed Cuckoo was present in `r ecoz("YBCU")` ecozones. Although the species was detected at 68 points across 18 plots, there was insufficient data to model abundance and models failed to converge. Detection probability was incredibly low ($p$ < 0.1), indicating that it was very rarely detected when present.

```{r ybcutable}
pres_tabler("YBCU", "Yellow-billed Cuckoo")
```

# Discussion

Our results were largely in line with previous findings. 

Increased forest cover and decreased fragmentation were associated with abundance of all three focal species.
A notable exception is the negative response of Worm-eating Warbler to forest cover at the 5 km scale specifically, which is mysterious. This species is considered a forest interior specialist that rarely occurs in fragmented landscapes and has large area requirements [@vitz2020]. Thus, there is little biological basis for a negative relationship between abundance and forest cover, and we suspect that it may be a statistical artifact. Additionally, the largely intact nature of the studied landscape with 83-95% forest cover within 5 km may have contributed to this unexpected result, as we did not predict relationships outside of observed ranges. Species can present contrasting relationships with microhabitat over landscapes; for example, in largely unforested landscapes, Cerulean Warblers prefer microhabitat with closed canopy, but in highly forested landscapes prefer some canopy disturbance [@boves2013]. 

Our study also highlights the importance of large contiguous forests because the edge density was generally low and percent forest generally high. Breeding density may not always be a good indicator of habitat quality for forest-interior Neotropical migrants because high densities may include unpaired males [@roberts1999]. However, the amount of largely unbroken forest cover in this region may avoid these issues of low breeding success despite high density, as large contiguous forests tend to have higher fledgling survival and fecundity [@roberts1999].
All three focal species are known to experience reduced fecundity in fragmented landscapes [@donovan2002a].
This landscape is largely intact based on our measurements of forest edge and patch size.
However, edges as defined by the National Land Cover Dataset may not accurately reflect sub-30m-scale variation in the landscape, such as canopy gaps, which can allow cowbird incursion into forested habitat and reduce fecundity for the focal species [@evans2020].

Cerulean Warblers' strong affinity for dry-mesic oak as well as sites close to water follow other research [@buehler2020]; slope and aspect may be important for their occurrence as well, and these details should be explored in future models. This species occurred at a relatively high mean canopy height and high basal area compared to many other unmodeled species.

Although this project aimed to quantify species-habitat relationships prior to major management, some activities occurred during the two-year study period. The privately-owned Boiling Springs effects monitoring plot was logged and several locations were burned between the 2021 and 2022 field seasons, including NGO F (Airport Rd.) and multiple Goshen Effects points near Gochenour Branch. We did not include these management activities in this analysis, as we did not collect sufficient information on which points were managed. It is possible that ignoring these management actions influenced our results; breeding densities of Worm-eating Warbler are reduced after fire and clearcut [@vitz2020]. Future work with this dataset could investigate the impacts of these actions on the bird communities at the locations, possibly using occupancy models rather than abundance to account for decreased sample size. 

The use of LiDAR to quantify forest structure should be further explored. Quantifying variables such as understory density, slope, and more detailed features of canopy and subcanopy, all of which can be important for the species we studied [@barnes2016], could get at fine-scale habitat associations in the study area that are relevant to intended management. For example, we used the coefficient of variation of canopy height to get at variability within stands, but there can be major differences in the understory that are obscured by an even-height canopy. For example, higher basal area typically indicates thicker stands, although many small-diameter trees can have an equivalent basal area to fewer large-diameter trees. It should be noted that our measurements of basal area were taken only at the site of the point count and nowhere else throughout the count circle, and that stand age would be a helpful discriminator for the general condition of the understory. LiDaR data may elucidate this relationship.

Maintaining mature forests, preventing fragmentation, and management actions that create the types of forest described here will support the abundance of Scarlet Tanager, Wood Thrush, and Worm-eating Warbler in the Virginia Highlands Focal Landscape. Conservation efforts should focus on protecting and restoring forested habitats that fulfill these crucial criteria to sustain these forest bird communities in the long term. Futhermore, management to increase structural diversity may benefit forest interior species in the long term by creating foraging habitat despite short-term decreases in site use post-management.

# Appendix

## Appendix I

```{r fig.cap = "Maps of ecozone distribution within each of the population monitoring plots. Circles indicate surveyed points.", dpi = 300}
knitr::include_graphics("output/plots/ecozone_comboplots2.png")
```

# Additional information

Scripts associated with this analysis are available at https://github.com/mlmassa/amjv_monitoring.

This project was funded under Agreement #0407.20.070428 between American bird Conservancy and National Fish and Wildlife Foundation. We thank Terry Flaherty, Megan Massa, Claire Nemes, and Atlee Wise for conducting bird counts and Emily Cohen, Amanda Duren, Todd Fearer, and A'Laurenye' McBeth for additional work in the field.

# References
